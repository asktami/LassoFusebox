[// a custom tag to get the real server name from the headers from greg willits// use because the [server_name] tag sometimes has problems with multiple virtual hosts on the same IP// Example: [thisServerName]if( !(lasso_tagexists('getServerName')) );define_tag('getServerName');local('host'=string_findregexp(client_headers,-find='(.*)HOST(.*)',-ignorecase)->get(3));local('subHost'=#host->split('.')->get(2));	#host->trim;	#subHost->trim;return(string(#subHost));/define_tag;/if;	//// this protects against malicious site Cross-Site Request Forgery Attack (CSRF)if(string(referrer_URL) != ''  &&  !string(referrer_URL)->Contains(getServerName) &&  (!string(referrer_URL)->Contains('TestSeverName')  || !string(referrer_URL)->Contains('LiveServerName')));'<br>Invalid Access!';abort;/if;// This list of browsers represents the minimum acceptable version// If an unlisted browser is encountered, assume it is okvar('browserBlock' = array('MSIE'='6', 'Safari'='313', 'Netscape'='7.2', 'Firefox'='1.0.6', 'Opera'='0'));var('browserOK' = 1);var('browser' = 'unknown');var('browserVerStr' = '0');var('browserMajorVer' = '0');var('browserMinorVer' = '0');var('minMinorVer' = '0');var('failReason' = 'unknown');local('temp' = '');iterate($browserBlock, #temp );// Opera/7.11 (Windows NT 5.0; U) [en]if(Client_Browser >> #temp->first);	var('browser' = #temp->first);	var('browserVerStr' = String_Extract(Client_Browser, -StartPosition=Client_Browser->Find(#temp->first) + String_Length($browser) + 1, -EndPosition=String_Length(Client_Browser)));		var('browserMajorVer' = integer($browserVerStr));			var('browserMinorVer' = String_Extract($browserVerStr, -StartPosition=String_Length($browserMajorVer)+2, -EndPosition=String_Length($browserVerStr)));			var('minMajorVer' = integer(#temp->second));		var('minMinorVer' = String_Extract($browserVerStr, -StartPosition=String_Length($browserMajorVer)+2, -EndPosition=String_Length($browserVerStr)) );		if(integer($minMajorVer) == 0);		var('browserOK' = 0 );		var('failReason'= 'incompatible');	/if;	if(integer($browserMajorVer) < Integer($minMajorVer));		var('browserOK' = 0 );		var('failReason'= 'major ver');	/if;	if( integer($browserMajorVer) == Integer($minMajorVer) && $browserMinorVer< $minMinorVer );		var('browserOK' = 0 );		var('failReason'= 'minor ver');	/if;/if;/iterate;if($browserOK == 1 );	include('fbx_LassoFusebox3.inc');else;	include('browserTest.inc');	abort;/if;// Lasso 9.1.4 does NOT have the [log] tag so do not include any logging code]