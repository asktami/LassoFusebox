[// a custom tag to get the real server name from the headers from greg willits// use because the [server_name] tag sometimes has problems with multiple virtual hosts on the same IP// Example: [thisServerName]if( !(lasso_tagexists('getServerName')) );define_tag('getServerName');local('host'=string_findregexp(client_headers,-find='(.*)HOST(.*)',-ignorecase)->get(3));local('subHost'=#host->split('.')->get(2));	#host->trim;	#subHost->trim;return(string(#subHost));/define_tag;/if;	//// this protects against malicious site Cross-Site Request Forgery Attack (CSRF)if(string(referrer_URL) != ''  &&  !string(referrer_URL)->Contains(getServerName) &&  (!string(referrer_URL)->Contains('TestSeverName')  || !string(referrer_URL)->Contains('LiveServerName')));'<br>Invalid Access!';abort;/if;include('fbx_LassoFusebox3.inc');// Lasso 9.1.4 does NOT have the [log] tag so do not include any logging code]